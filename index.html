<!DOCTYPE html>
<html manifest="placesandthings.manifest">
	<head>
	<title>Places and Things</title>
	<link rel="stylesheet" href="css/jquery.mobile-1.0a1.min.css" />
	<script src="js/jquery-1.4.3.min.js"></script>
	<script src="js/jquery.mobile-1.0a1.min.js"></script>
        <script src="js/modernizr-1.5.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  if (Modernizr.localstorage) {
    // window.localStorage is available
    displayPlaces()
  } else {
    window.location.hash = "#unsupported"
  }
});

var place_prefix = "pat.p."

function addPlace(name) {
  window.localStorage[place_prefix+name] = name
}

function debugPlaces() {
  var p = getPlaces();
  $.each(p, function(k,v) {
    alert("key: "+k+", value: "+v);
  });
}

function displayPlaces() {
  var p = getPlaces();
  var list = $("<ul>", {"class": "ui-listbox-list",
                        "data-inset": "true"}
              ).appendTo('#placesIntro');
  $.each(p,function(k,v) {
    $('<li><a href="#'+k+'">'+k+'</a></li>').appendTo(list);
  });
  list.listview();
}

function getPlaces() {
  // places are identified as keys with prefix "pat.p."
  var places = new Object();
  keycount = window.localStorage.length;
  for(i=0;i<keycount;i++) {
    key = localStorage.key(i);
    if (key.substr(0,6) == place_prefix) {
      places[key.substr(6)] = window.localStorage.getItem(key)
    }
  }
  return places
}

</script>
</head>
<body>
<div data-role="page" data-theme="b" id="home">

	<div data-role="header">
		<h1>Places and Things</h1>
	</div><!-- /header -->

	<div data-role="content">
          <p>Welcome to Places and Things, your personal inventory management tool.</p>
          <ul data-role="listview" data-inset="true" data-theme="a" data-dividertheme="b">
            <li data-role="list-divider">Inventory</li>
            <li><a href="#places">Places</a></li>
            <li><a href="#things">Things</a></li>
          </ul>

	</div><!-- /content -->

	<div data-role="footer">
		<h4></h4>
	</div><!-- /footer -->
</div><!-- /page -->

<div data-role="page" id="places">

	<div data-role="header">
		<h1>My Places</h1>
	</div><!-- /header -->

	<div data-role="content">
          <p id="placesIntro"></p>
          <a href="#addPlace" data-inline="true" data-role="button" data-icon="plus">Add Place</a>
	</div><!-- /content -->

	<div data-role="footer">
		<h4></h4>
	</div><!-- /footer -->
</div><!-- /page -->

<div data-role="page" id="things">

	<div data-role="header">
		<h1>My Things</h1>
	</div><!-- /header -->

	<div data-role="content">
		<p>View all things here.</p>
	</div><!-- /content -->

	<div data-role="footer">
		<h4></h4>
	</div><!-- /footer -->
</div><!-- /page -->

<div data-role="page" id="unsupported">

	<div data-role="header">
		<h1>Sorry!</h1>
	</div><!-- /header -->

	<div data-role="content">
		<p>Your browser is not supported.</p>
	</div><!-- /content -->

	<div data-role="footer">
		<h4></h4>
	</div><!-- /footer -->
</div><!-- /page -->

</body>
</html>
